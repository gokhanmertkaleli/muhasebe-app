{
  "info": {
    "name": "Muhasebe App - API Tests",
    "description": "Muhasebe uygulaması için kapsamlı test koleksiyonu",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:8080",
      "type": "string"
    },
    {
      "key": "accessToken",
      "value": "",
      "type": "string"
    },
    {
      "key": "refreshToken",
      "value": "",
      "type": "string"
    },
    {
      "key": "companyId",
      "value": "",
      "type": "string"
    },
    {
      "key": "customerId",
      "value": "",
      "type": "string"
    },
    {
      "key": "supplierId",
      "value": "",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "Authentication",
      "item": [
        {
          "name": "Register - Admin User",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200 || pm.response.code === 201) {",
                  "    var jsonData = pm.response.json();",
                  "    pm.collectionVariables.set('accessToken', jsonData.accessToken);",
                  "    pm.collectionVariables.set('refreshToken', jsonData.refreshToken);",
                  "    pm.collectionVariables.set('companyId', jsonData.companyId);",
                  "    pm.test('Registration successful', function () {",
                  "        pm.response.to.have.status(200);",
                  "    });",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"adminuser\",\n  \"email\": \"admin@muhasebe.com\",\n  \"password\": \"Admin123!\",\n  \"firstName\": \"Admin\",\n  \"lastName\": \"User\",\n  \"phone\": \"05551234567\",\n  \"role\": \"ADMIN\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/auth/register",
              "host": ["{{baseUrl}}"],
              "path": ["api", "auth", "register"]
            }
          }
        },
        {
          "name": "Register - Regular User",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200 || pm.response.code === 201) {",
                  "    var jsonData = pm.response.json();",
                  "    pm.collectionVariables.set('accessToken', jsonData.accessToken);",
                  "    pm.collectionVariables.set('refreshToken', jsonData.refreshToken);",
                  "    pm.collectionVariables.set('companyId', jsonData.companyId);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"testuser\",\n  \"email\": \"test@muhasebe.com\",\n  \"password\": \"Test123!\",\n  \"firstName\": \"Test\",\n  \"lastName\": \"User\",\n  \"phone\": \"05559876543\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/auth/register",
              "host": ["{{baseUrl}}"],
              "path": ["api", "auth", "register"]
            }
          }
        },
        {
          "name": "Login",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var jsonData = pm.response.json();",
                  "pm.collectionVariables.set('accessToken', jsonData.accessToken);",
                  "pm.collectionVariables.set('refreshToken', jsonData.refreshToken);",
                  "pm.collectionVariables.set('companyId', jsonData.companyId);",
                  "",
                  "pm.test('Login successful', function () {",
                  "    pm.response.to.have.status(200);",
                  "    pm.expect(jsonData.accessToken).to.exist;",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"usernameOrEmail\": \"adminuser\",\n  \"password\": \"Admin123!\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/auth/login",
              "host": ["{{baseUrl}}"],
              "path": ["api", "auth", "login"]
            }
          }
        },
        {
          "name": "Refresh Token",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"refreshToken\": \"{{refreshToken}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/auth/refresh",
              "host": ["{{baseUrl}}"],
              "path": ["api", "auth", "refresh"]
            }
          }
        }
      ]
    },
    {
      "name": "Customers",
      "item": [
        {
          "name": "Create Customer - Corporate",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    var jsonData = pm.response.json();",
                  "    pm.collectionVariables.set('customerId', jsonData.id);",
                  "    pm.test('Customer created successfully', function () {",
                  "        pm.response.to.have.status(201);",
                  "        pm.expect(jsonData.name).to.eql('ABC Ticaret Ltd. Şti.');",
                  "    });",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"ABC Ticaret Ltd. Şti.\",\n  \"contactPerson\": \"Ahmet Yılmaz\",\n  \"taxNumber\": \"1234567891\",\n  \"taxOffice\": \"Kadıköy\",\n  \"address\": \"Sahil Caddesi No:15 Daire:4\",\n  \"city\": \"İstanbul\",\n  \"district\": \"Kadıköy\",\n  \"postalCode\": \"34710\",\n  \"country\": \"Türkiye\",\n  \"phone\": \"0216 555 1234\",\n  \"mobile\": \"0532 123 4567\",\n  \"email\": \"abc@ticaret.com\",\n  \"website\": \"www.abcticaret.com\",\n  \"customerType\": \"Kurumsal\",\n  \"paymentTerms\": 30,\n  \"creditLimit\": 50000.00,\n  \"notes\": \"Öncelikli müşteri\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/companies/{{companyId}}/customers",
              "host": ["{{baseUrl}}"],
              "path": ["api", "companies", "{{companyId}}", "customers"]
            }
          }
        },
        {
          "name": "Create Customer - Individual",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Mehmet Demir\",\n  \"identityNumber\": \"12345678901\",\n  \"address\": \"Çiçek Sokak No:8\",\n  \"city\": \"Ankara\",\n  \"district\": \"Çankaya\",\n  \"phone\": \"0312 555 9876\",\n  \"mobile\": \"0533 987 6543\",\n  \"email\": \"mehmet@example.com\",\n  \"customerType\": \"Bireysel\",\n  \"paymentTerms\": 15,\n  \"creditLimit\": 10000.00\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/companies/{{companyId}}/customers",
              "host": ["{{baseUrl}}"],
              "path": ["api", "companies", "{{companyId}}", "customers"]
            }
          }
        },
        {
          "name": "Get All Customers",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/companies/{{companyId}}/customers?page=0&size=10&sortBy=name&sortDir=asc",
              "host": ["{{baseUrl}}"],
              "path": ["api", "companies", "{{companyId}}", "customers"],
              "query": [
                {
                  "key": "page",
                  "value": "0"
                },
                {
                  "key": "size",
                  "value": "10"
                },
                {
                  "key": "sortBy",
                  "value": "name"
                },
                {
                  "key": "sortDir",
                  "value": "asc"
                }
              ]
            }
          }
        },
        {
          "name": "Get Customer by ID",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/companies/{{companyId}}/customers/{{customerId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "companies", "{{companyId}}", "customers", "{{customerId}}"]
            }
          }
        },
        {
          "name": "Update Customer",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"ABC Ticaret Ltd. Şti. (Güncellendi)\",\n  \"contactPerson\": \"Ahmet Yılmaz\",\n  \"taxNumber\": \"1234567891\",\n  \"taxOffice\": \"Kadıköy\",\n  \"address\": \"Yeni Adres Caddesi No:20\",\n  \"city\": \"İstanbul\",\n  \"district\": \"Kadıköy\",\n  \"phone\": \"0216 555 9999\",\n  \"mobile\": \"0532 123 4567\",\n  \"email\": \"abc@ticaret.com\",\n  \"customerType\": \"Kurumsal\",\n  \"paymentTerms\": 45,\n  \"creditLimit\": 75000.00\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/companies/{{companyId}}/customers/{{customerId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "companies", "{{companyId}}", "customers", "{{customerId}}"]
            }
          }
        },
        {
          "name": "Search Customers",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/companies/{{companyId}}/customers/search?keyword=ABC&page=0&size=10",
              "host": ["{{baseUrl}}"],
              "path": ["api", "companies", "{{companyId}}", "customers", "search"],
              "query": [
                {
                  "key": "keyword",
                  "value": "ABC"
                },
                {
                  "key": "page",
                  "value": "0"
                },
                {
                  "key": "size",
                  "value": "10"
                }
              ]
            }
          }
        },
        {
          "name": "Get Active Customers",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/companies/{{companyId}}/customers/active?page=0&size=10",
              "host": ["{{baseUrl}}"],
              "path": ["api", "companies", "{{companyId}}", "customers", "active"],
              "query": [
                {
                  "key": "page",
                  "value": "0"
                },
                {
                  "key": "size",
                  "value": "10"
                }
              ]
            }
          }
        },
        {
          "name": "Get Customers with Debt",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/companies/{{companyId}}/customers/with-debt",
              "host": ["{{baseUrl}}"],
              "path": ["api", "companies", "{{companyId}}", "customers", "with-debt"]
            }
          }
        },
        {
          "name": "Delete Customer",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/companies/{{companyId}}/customers/{{customerId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "companies", "{{companyId}}", "customers", "{{customerId}}"]
            }
          }
        }
      ]
    },
    {
      "name": "Suppliers",
      "item": [
        {
          "name": "Create Supplier",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    var jsonData = pm.response.json();",
                  "    pm.collectionVariables.set('supplierId', jsonData.id);",
                  "    pm.test('Supplier created successfully', function () {",
                  "        pm.response.to.have.status(201);",
                  "    });",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"XYZ Tedarik A.Ş.\",\n  \"contactPerson\": \"Ayşe Kaya\",\n  \"taxNumber\": \"9876543210\",\n  \"taxOffice\": \"Beşiktaş\",\n  \"address\": \"Deniz Sokak No:10\",\n  \"city\": \"İstanbul\",\n  \"district\": \"Beşiktaş\",\n  \"postalCode\": \"34340\",\n  \"country\": \"Türkiye\",\n  \"phone\": \"0212 555 6789\",\n  \"mobile\": \"0535 678 9012\",\n  \"email\": \"xyz@tedarik.com\",\n  \"website\": \"www.xyztedarik.com\",\n  \"supplierType\": \"Distribütör\",\n  \"paymentTerms\": 60,\n  \"bankName\": \"İş Bankası\",\n  \"iban\": \"TR330006100519786457841326\",\n  \"notes\": \"Ana tedarikçi\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/companies/{{companyId}}/suppliers",
              "host": ["{{baseUrl}}"],
              "path": ["api", "companies", "{{companyId}}", "suppliers"]
            }
          }
        },
        {
          "name": "Get All Suppliers",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/companies/{{companyId}}/suppliers?page=0&size=10&sortBy=name&sortDir=asc",
              "host": ["{{baseUrl}}"],
              "path": ["api", "companies", "{{companyId}}", "suppliers"],
              "query": [
                {
                  "key": "page",
                  "value": "0"
                },
                {
                  "key": "size",
                  "value": "10"
                },
                {
                  "key": "sortBy",
                  "value": "name"
                },
                {
                  "key": "sortDir",
                  "value": "asc"
                }
              ]
            }
          }
        },
        {
          "name": "Get Supplier by ID",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/companies/{{companyId}}/suppliers/{{supplierId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "companies", "{{companyId}}", "suppliers", "{{supplierId}}"]
            }
          }
        },
        {
          "name": "Update Supplier",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"XYZ Tedarik A.Ş. (Güncellendi)\",\n  \"contactPerson\": \"Ayşe Kaya\",\n  \"taxNumber\": \"9876543210\",\n  \"taxOffice\": \"Beşiktaş\",\n  \"address\": \"Yeni Deniz Sokak No:15\",\n  \"city\": \"İstanbul\",\n  \"district\": \"Beşiktaş\",\n  \"phone\": \"0212 555 9999\",\n  \"mobile\": \"0535 678 9012\",\n  \"email\": \"xyz@tedarik.com\",\n  \"supplierType\": \"Üretici\",\n  \"paymentTerms\": 90,\n  \"bankName\": \"İş Bankası\",\n  \"iban\": \"TR330006100519786457841326\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/companies/{{companyId}}/suppliers/{{supplierId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "companies", "{{companyId}}", "suppliers", "{{supplierId}}"]
            }
          }
        },
        {
          "name": "Search Suppliers",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/companies/{{companyId}}/suppliers/search?keyword=XYZ&page=0&size=10",
              "host": ["{{baseUrl}}"],
              "path": ["api", "companies", "{{companyId}}", "suppliers", "search"],
              "query": [
                {
                  "key": "keyword",
                  "value": "XYZ"
                },
                {
                  "key": "page",
                  "value": "0"
                },
                {
                  "key": "size",
                  "value": "10"
                }
              ]
            }
          }
        },
        {
          "name": "Get Active Suppliers",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/companies/{{companyId}}/suppliers/active?page=0&size=10",
              "host": ["{{baseUrl}}"],
              "path": ["api", "companies", "{{companyId}}", "suppliers", "active"],
              "query": [
                {
                  "key": "page",
                  "value": "0"
                },
                {
                  "key": "size",
                  "value": "10"
                }
              ]
            }
          }
        },
        {
          "name": "Delete Supplier",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{accessToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/companies/{{companyId}}/suppliers/{{supplierId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "companies", "{{companyId}}", "suppliers", "{{supplierId}}"]
            }
          }
        }
      ]
    }
  ]
}